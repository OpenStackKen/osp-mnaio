#!/bin/bash

set -o pipefail
set -evx

# overcloud deploy script generated by osp-mnaio
source /home/stack/stackrc
openstack overcloud deploy --templates \
   -e /home/stack/templates/node-info.yaml \
   -e /home/stack/templates/undercloud_ssl_camap.yaml \
   -e /home/stack/templates/network-environment.yaml \
   -e /usr/share/openstack-tripleo-heat-templates/environments/network-isolation.yaml \
{% if redhat_overcloud_register | bool %}
   -e /home/stack/templates/rhel-registration/environment-rhel-registration.yaml \
   -e /home/stack/templates/rhel-registration/rhel-registration-resource-registry.yaml \
{% endif %}
   --ntp-server pool.ntp.org \
   2>&1 | tee /home/stack/logs/overcloud_install.log
